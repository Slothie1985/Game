<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Mythimon</title>

<style>
body {
  background:#111;
  color:white;
  font-family:Arial;
  text-align:center;
}
canvas {
  background:#333;
  border:2px solid #555;
}
#ui button {
  font-size:18px;
  padding:10px;
  margin:5px;
}
</style>
</head>

<body>

<h1>MYTHIMON</h1>
<p>Move with arrows or buttons. Grass = encounters.</p>

<canvas id="game" width="300" height="300"></canvas>

<div id="ui"></div>

<div id="controls">
  <button onclick="move('up')">⬆️</button><br>
  <button onclick="move('left')">⬅️</button>
  <button onclick="move('down')">⬇️</button>
  <button onclick="move('right')">➡️</button>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const ui = document.getElementById("ui");

const tile = 60;
const size = 5;

const map = [
 [1,0,0,0,1],
 [0,1,0,1,0],
 [0,0,0,0,0],
 [1,0,0,1,0],
 [0,0,1,0,0]
];

let player = {
  x:2,y:2,
  hp:30,
  maxHp:30,
  level:1,
  xp:0,
  name:"Spryte"
};

const monsters = [
 {name:"Flameling", hp:20, atk:5, xp:10, color:"red"},
 {name:"Leaflit", hp:18, atk:4, xp:8, color:"green"},
 {name:"Aquabub", hp:22, atk:4, xp:9, color:"blue"}
];

let wild = null;
let inBattle = false;

function draw() {
 ctx.clearRect(0,0,300,300);
 for(let y=0;y<size;y++){
  for(let x=0;x<size;x++){
   ctx.fillStyle = map[y][x] ? "green" : "#555";
   ctx.fillRect(x*tile,y*tile,tile-2,tile-2);
  }
 }
 ctx.fillStyle="gold";
 ctx.fillRect(player.x*tile,player.y*tile,tile-2,tile-2);
}

function move(dir){
 if(inBattle) return;
 let dx=0,dy=0;
 if(dir==="up")dy=-1;
 if(dir==="down")dy=1;
 if(dir==="left")dx=-1;
 if(dir==="right")dx=1;

 let nx=player.x+dx;
 let ny=player.y+dy;
 if(nx>=0&&ny>=0&&nx<size&&ny<size){
  player.x=nx;player.y=ny;
  if(map[ny][nx]===1 && Math.random()<0.4){
    startBattle();
  }
 }
 draw();
}

document.addEventListener("keydown",e=>{
 if(e.key.includes("Arrow"))
  move(e.key.replace("Arrow","").toLowerCase());
});

function startBattle(){
 inBattle=true;
 wild=JSON.parse(JSON.stringify(
  monsters[Math.floor(Math.random()*monsters.length)]
 ));
 ui.innerHTML=`
 <h2>Wild ${wild.name} appeared!</h2>
 <p>Your HP: ${player.hp}/${player.maxHp}</p>
 <p>${wild.name} HP: ${wild.hp}</p>
 <button onclick="attack()">Attack</button>
 `;
}

function attack(){
 wild.hp-=5;
 if(wild.hp<=0){
  winBattle();
  return;
 }
 player.hp-=wild.atk;
 if(player.hp<=0){
  ui.innerHTML="<h2>You fainted!</h2>";
  inBattle=false;
  player.hp=player.maxHp;
  return;
 }
 updateBattleUI();
}

function updateBattleUI(){
 ui.innerHTML=`
 <h2>Battle</h2>
 <p>${player.name} HP: ${player.hp}/${player.maxHp}</p>
 <p>${wild.name} HP: ${wild.hp}</p>
 <button onclick="attack()">Attack</button>
 `;
}

function winBattle(){
 player.xp+=wild.xp;
 inBattle=false;
 ui.innerHTML=`<h2>You defeated ${wild.name}!</h2>`;
 levelUp();
}

function levelUp(){
 if(player.xp>=player.level*20){
  player.level++;
  player.maxHp+=10;
  player.hp=player.maxHp;
  ui.innerHTML+=`<p>Level Up! Lv ${player.level}</p>`;
  if(player.level===5){
    player.name="Spryteon";
    ui.innerHTML+=`<p>Your Mythimon evolved!</p>`;
  }
 }
}

draw();
</script>

</body>
</html>
